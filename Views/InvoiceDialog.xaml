<Window x:Class="AuroraInvoice.Views.InvoiceDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Invoice Details"
        Height="700"
        Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
                  x:Name="HeaderText"
                  Text="New Invoice"
                  Style="{StaticResource HeaderText}"/>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Customer *"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <ComboBox x:Name="CustomerComboBox"
                                 Style="{StaticResource ModernComboBox}"
                                 DisplayMemberPath="Name"
                                 Margin="0,0,0,16"/>

                        <TextBlock Text="Invoice Date *"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <DatePicker x:Name="InvoiceDatePicker"
                                   Margin="0,0,0,16"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Invoice Number *"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <TextBox x:Name="InvoiceNumberTextBox"
                                Style="{StaticResource ModernTextBox}"
                                Margin="0,0,0,16"/>

                        <TextBlock Text="Due Date *"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <DatePicker x:Name="DueDatePicker"
                                   Margin="0,0,0,16"/>
                    </StackPanel>
                </Grid>

                <Separator Margin="0,8,0,16"/>

                <TextBlock Text="Invoice Items"
                          FontSize="16"
                          FontWeight="SemiBold"
                          Margin="0,0,0,12"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Description"
                                  FontWeight="SemiBold"
                                  FontSize="12"
                                  Margin="0,0,0,8"/>
                        <TextBox x:Name="ItemDescriptionTextBox"
                                Style="{StaticResource ModernTextBox}"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Service Date"
                                  FontWeight="SemiBold"
                                  FontSize="12"
                                  Margin="0,0,0,8"/>
                        <DatePicker x:Name="ItemServiceDatePicker"/>
                    </StackPanel>

                    <StackPanel Grid.Column="4">
                        <TextBlock Text="Quantity"
                                  FontWeight="SemiBold"
                                  FontSize="12"
                                  Margin="0,0,0,8"/>
                        <TextBox x:Name="ItemQuantityTextBox"
                                Style="{StaticResource ModernTextBox}"
                                Text="1"/>
                    </StackPanel>

                    <StackPanel Grid.Column="6">
                        <TextBlock Text="Unit Price"
                                  FontWeight="SemiBold"
                                  FontSize="12"
                                  Margin="0,0,0,8"/>
                        <TextBox x:Name="ItemPriceTextBox"
                                Style="{StaticResource ModernTextBox}"
                                TextChanged="CalculateTotals"/>
                    </StackPanel>

                    <StackPanel Grid.Column="8"
                               VerticalAlignment="Bottom">
                        <Button Content="Add Item"
                               Style="{StaticResource ModernButton}"
                               Padding="12,8"
                               Click="AddItem_Click"/>
                    </StackPanel>
                </Grid>

                <DataGrid x:Name="ItemsGrid"
                         Style="{StaticResource ModernDataGrid}"
                         Height="200"
                         Margin="0,16,0,16">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="2*"/>
                        <DataGridTextColumn Header="Service Date" Binding="{Binding ServiceDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                        <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="*"/>
                        <DataGridTextColumn Header="Unit Price" Binding="{Binding UnitPrice, StringFormat=C}" Width="*"/>
                        <DataGridTextColumn Header="Total" Binding="{Binding LineTotal, StringFormat=C}" Width="*"/>
                        <DataGridTemplateColumn Header="Remove" Width="Auto">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="X"
                                           Style="{StaticResource SecondaryButton}"
                                           Padding="8,4"
                                           Click="RemoveItem_Click"
                                           Tag="{Binding}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <Border BorderBrush="{StaticResource BorderBrush}"
                       BorderThickness="1"
                       Padding="16"
                       Background="{StaticResource HoverBrush}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0"
                                  Text="Subtotal:"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <TextBlock Grid.Row="0" Grid.Column="1"
                                  x:Name="SubtotalText"
                                  Text="$0.00"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>

                        <TextBlock Grid.Row="1" Grid.Column="0"
                                  Text="GST (10%):"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <TextBlock Grid.Row="1" Grid.Column="1"
                                  x:Name="GSTText"
                                  Text="$0.00"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>

                        <TextBlock Grid.Row="2" Grid.Column="0"
                                  Text="Total:"
                                  FontSize="18"
                                  FontWeight="Bold"
                                  Foreground="{StaticResource PrimaryBrush}"/>
                        <TextBlock Grid.Row="2" Grid.Column="1"
                                  x:Name="TotalText"
                                  Text="$0.00"
                                  FontSize="18"
                                  FontWeight="Bold"
                                  Foreground="{StaticResource PrimaryBrush}"/>
                    </Grid>
                </Border>

                <Grid Margin="0,16,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Status"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <ComboBox x:Name="StatusComboBox"
                                 Style="{StaticResource ModernComboBox}">
                            <ComboBoxItem Content="Draft" IsSelected="True"/>
                            <ComboBoxItem Content="Sent"/>
                            <ComboBoxItem Content="Paid"/>
                            <ComboBoxItem Content="Overdue"/>
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Notes"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,8"/>
                        <TextBox x:Name="NotesTextBox"
                                Style="{StaticResource ModernTextBox}"
                                Height="60"
                                AcceptsReturn="True"
                                TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </ScrollViewer>

        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="1"
                   Content="Save Invoice"
                   Style="{StaticResource ModernButton}"
                   Width="120"
                   Click="Save_Click"/>

            <Button Grid.Column="3"
                   Content="Cancel"
                   Style="{StaticResource SecondaryButton}"
                   Width="100"
                   Click="Cancel_Click"/>
        </Grid>
    </Grid>
</Window>